<!--item-detail.wxml-->
<view class="container">
  <!-- å¤´éƒ¨å¯¼èˆª -->
  <view class="header" style="padding-top: {{statusBarHeight + 20}}rpx;">
    <view class="back-btn" bindtap="goBack">
      <text class="back-icon">â€¹</text>
    </view>
    <view class="seller-info" bindtap="navigateToSellerProfile">
      <image class="seller-avatar" src="{{item.seller.avatar}}" mode="aspectFill"></image>
      <text class="seller-name">{{item.seller.username}}</text>
    </view>
  </view>

  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <view wx:else>
    <!-- å•†å“å›¾ç‰‡è½®æ’­ -->
    <view class="image-container">
      <swiper class="image-swiper" indicator-dots="{{false}}" autoplay="{{false}}" 
              bindchange="onImageChange">
        <swiper-item wx:for="{{item.images}}" wx:key="index">
          <image class="product-image" src="{{item}}" mode="aspectFill" 
                 bindtap="previewImage" data-src="{{item}}"></image>
        </swiper-item>
      </swiper>
      <view class="image-indicator">{{currentImageIndex + 1}}/{{item.images.length}}</view>
    </view>

    <!-- å•†å“ä¿¡æ¯ -->
    <view class="product-info">
      <view class="product-price">Â¥{{item.price}}</view>
      <view class="product-meta">
        <text>å‘å¸ƒæ—¶é—´: {{item.formattedPublishTime}}</text>
        <text>æµè§ˆï¼š{{item.viewCount}}æ¬¡</text>
      </view>
    </view>

    <!-- å•†å“æè¿° -->
    <view class="product-description">
      <view class="description-title">å•†å“æè¿°</view>
      <view class="description-content">{{item.description}}</view>
    </view>

    <!-- è¯„è®ºåŒº -->
    <view class="comments-section">
      <view class="comments-header">å…±{{comments.length}}æ¡ç•™è¨€</view>
      
      <!-- è¯„è®ºè¾“å…¥æ¡† -->
      <view class="comment-input">
        <image class="user-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
        <input class="input-box" type="text" placeholder="è¯´ç‚¹ä»€ä¹ˆ" 
               value="{{newComment}}" bindinput="onCommentInput" 
               bindconfirm="sendComment" confirm-type="send"/>
      </view>

      <!-- è¯„è®ºåˆ—è¡¨ -->
      <view class="comment-item" wx:for="{{comments}}" wx:key="id">
        <image class="comment-avatar" src="{{item.avatar}}"></image>
        <view class="comment-content">
          <view class="comment-header">
            <text class="comment-username">{{item.username}}</text>
            <!-- æ¥¼ä¸»æ ‡å¿— -->
            <text wx:if="{{item.isAuthor}}" class="author-badge">æ¥¼ä¸»</text>
            <text class="comment-time">{{item.createTime}}</text>
          </view>
          <text class="comment-text">{{item.content}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <view class="action-btn" bindtap="sendComment">
      <view class="action-icon comment-icon">ğŸ’¬</view>
      <text>è¯„è®º</text>
    </view>
    <view class="action-btn {{isLiked ? 'liked' : ''}}" bindtap="toggleLike">
      <view class="action-icon like-icon">{{isLiked ? 'â¤ï¸' : 'ğŸ¤'}}</view>
      <text>{{isLiked ? 'æ”¶è—' : 'æ”¶è—'}}</text>
    </view>
    <view class="action-btn" bindtap="onShareClick">
      <view class="action-icon share-icon">ğŸ“¤</view>
      <text>åˆ†äº«</text>
    </view>
    <button class="contact-btn" bindtap="contactSeller">è”ç³»å–å®¶</button>
  </view>
</view>