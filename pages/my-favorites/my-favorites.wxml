<!-- pages/my-favorites/my-favorites.wxml -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-wrapper">
    <view class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view wx:elif="{{error}}" class="error-wrapper">
    <view class="error">
      <text>{{error}}</text>
      <button class="retry-btn" bindtap="loadFavoriteItems">é‡è¯•</button>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view wx:else>
    <!-- ç±»å‹ç­›é€‰æ ‡ç­¾ - å›ºå®šåœ¨é¡¶éƒ¨ -->
    <view class="type-tabs">
      <view 
        wx:for="{{typeOptions}}" 
        wx:key="key"
        class="type-tab {{activeType === item.key ? 'active' : ''}}"
        data-type="{{item.key}}"
        bindtap="switchType"
      >
        <text class="tab-label">{{item.label}}</text>
        <text class="tab-count">({{item.count}})</text>
      </view>
    </view>

    <!-- å•†å“åˆ—è¡¨ -->
    <view class="items-container">
      <view wx:if="{{filteredItems.length === 0}}" class="empty-state">
        <image class="empty-icon" src="/images/like.png" mode="aspectFit" />
        <text class="empty-text">æš‚æ— æ”¶è—</text>
        <text class="empty-tip">
          {{activeType === 'all' ? 'è¿˜æ²¡æœ‰æ”¶è—ä»»ä½•å•†å“' : 'è¯¥ç±»å‹ä¸‹æš‚æ— æ”¶è—'}}
        </text>
      </view>

      <view wx:else class="items-list">
        <view 
          wx:for="{{filteredItems}}" 
          wx:key="id"
          class="item-card"
          data-item-id="{{item.id}}"
          bindtap="onItemTap"
        >
          <!-- å•†å“ä¸»è¦å†…å®¹ï¼šå·¦å›¾å³æ–‡å¸ƒå±€ -->
          <view class="item-main-content">
            <!-- å·¦ä¾§ï¼šå•†å“ç¼©ç•¥å›¾ -->
            <view class="item-image-section">
              <image 
                class="item-thumbnail" 
                src="{{item.images && item.images[0] ? item.images[0] : '/images/placeholder.png'}}"
                mode="aspectFill"
              />
              <!-- äº¤æ˜“ç±»å‹æ ‡ç­¾ -->
              <view class="trade-type-tag {{item.tradeType === 'sell' ? 'type-sell' : 'type-buy'}}">
                {{item.tradeTypeText}}
              </view>
            </view>

            <!-- å³ä¾§ï¼šå•†å“ä¿¡æ¯ -->
            <view class="item-detail-section">
              <!-- å•†å“æ ‡é¢˜ -->
              <view class="item-title">{{item.title}}</view>
              
              <!-- å•†å“æè¿° -->
              <view class="item-description">{{item.description}}</view>
              
              <!-- å•†å“ä»·æ ¼ -->
              <view class="item-price">
                <text class="price-symbol">{{item.tradeType === 'sell' ? 'Â¥' : 'é¢„ç®—Â¥'}}</text>
                <text class="price-value">{{item.price}}</text>
              </view>
              
              <!-- æ”¶è—æ—¶é—´å’Œç»Ÿè®¡ä¿¡æ¯ -->
              <view class="item-meta">
                <text class="favorite-time">æ”¶è—ï¼š{{item.favoriteTime}}</text>
                <view class="item-stats">
                  <text class="stat-item">ğŸ‘€ {{item.viewCount}}</text>
                  <text class="stat-item">â¤ï¸ {{item.likeCount}}</text>
                </view>
              </view>
            </view>
          </view>

          <!-- å‘å¸ƒè€…ä¿¡æ¯åŒºåŸŸ -->
          <view class="author-info">
            <view class="author-details">
              <image class="author-avatar" src="{{item.authorAvatar}}" />
              <view class="author-text">
                <text class="author-info-label">{{item.tradeType === 'sell' ? 'å–å®¶' : 'æ±‚è´­è€…'}}</text>
                <text class="author-name">{{item.authorName}}</text>
              </view>
            </view>
            <text class="contact-info" wx:if="{{item.contactInfo}}">{{item.contactInfo}}</text>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="item-actions">
            <button 
              class="action-btn secondary"
              data-item-id="{{item.id}}"
              catchtap="contactAuthor"
            >
              {{item.actionText}}
            </button>
            <button 
              class="action-btn tertiary"
              data-item-id="{{item.id}}"
              catchtap="shareItem"
            >
              åˆ†äº«
            </button>
            <button 
              class="action-btn danger"
              data-item-id="{{item.id}}"
              catchtap="unfavoriteItem"
            >
              å–æ¶ˆæ”¶è—
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>