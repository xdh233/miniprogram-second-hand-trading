<view class="container">
  <!-- å®Œå…¨æ¨¡ä»¿é¦–é¡µçš„ç»“æ„ -->
  <view class="content-container">
    <!-- æœç´¢æ  - å’Œé¦–é¡µä¸€æ ·å›ºå®š -->
    <view class="search-header">
      <view class="search-box">
        <icon class="search-icon" type="search" size="14" />
        <input 
          class="search-input"
          placeholder="æœç´¢è”ç³»äººæˆ–æ¶ˆæ¯å†…å®¹" 
          placeholder-class="search-placeholder"
          value="{{searchText}}"
          bindinput="onSearchInput"
        />
      </view>
      <!-- å…¨éƒ¨å·²è¯»æŒ‰é’® -->
      <view class="mark-all-read" bindtap="markAllAsRead" wx:if="{{chatList.length > 0}}">
        <text>å…¨éƒ¨å·²è¯»</text>
      </view>
    </view>

    <!-- æ¶ˆæ¯å®¹å™¨ - æ¨¡ä»¿é¦–é¡µçš„ posts-container -->
    <scroll-view 
      class="messages-container"
      scroll-y
      enable-back-to-top
      refresher-enabled
      refresher-triggered="{{refreshing}}"
      bindrefresherrefresh="onPullDownRefresh"
    >
      <!-- æ¶ˆæ¯åˆ†ç±» -->
      <view class="message-types">
        <view class="type-item" bindtap="navigateToMentions">
          <image class="type-icon-image" src="../../images/at-bold.png" mode="aspectFit" />
          <text class="type-text">æåˆ°æˆ‘çš„</text>
          <view class="badge" wx:if="{{mentionCount > 0}}">{{mentionCount}}</view>
        </view>
        <view class="type-item" bindtap="navigateToComments">
          <image class="type-icon-image" src="../../images/comment_fill.png" mode="aspectFit" />
          <text class="type-text">è¯„è®º</text>
          <view class="badge" wx:if="{{commentCount > 0}}">{{commentCount}}</view>
        </view>
        <view class="type-item" bindtap="navigateToLikes">
          <image class="type-icon-image" src="../../images/like_fill.png" mode="aspectFit" />
          <text class="type-text">ç‚¹èµ</text>
          <view class="badge" wx:if="{{likeCount > 0}}">{{likeCount}}</view>
        </view>
        <view class="type-item" bindtap="startNewChat">
          <image class="type-icon-image" src="../../images/add_bold.png" mode="aspectFit" />
          <text class="type-text">æ–°èŠå¤©</text>
        </view>
      </view>

      <!-- åˆ†éš”çº¿ -->
      <view class="divider"></view>

      <!-- èŠå¤©åˆ—è¡¨ -->
      <view class="section-header" wx:if="{{chatList.length > 0}}">
        <text class="section-title">æœ€è¿‘èŠå¤©</text>
        <text class="chat-count">{{chatList.length}}ä¸ªä¼šè¯</text>
      </view>

      <!-- èŠå¤©åˆ—è¡¨å†…å®¹ -->
      <view class="chat-list" wx:if="{{chatList.length > 0}}">
        <view class="chat-item {{item.isPinned ? 'pinned' : ''}} {{item.isMuted ? 'muted' : ''}}" 
          wx:for="{{chatList}}" 
          wx:key="id"
          data-item="{{item}}"
          bindtap="navigateToChat"
          bindlongpress="onLongPressChat"
        >
          <!-- ç½®é¡¶æ ‡è¯† -->
          <view class="pin-indicator" wx:if="{{item.isPinned}}">ğŸ“Œ</view>
          
          <view class="chat-main">
            <!-- å¤´åƒåŒºåŸŸ -->
            <view class="avatar-container">
              <image class="avatar" src="{{item.avatar}}" mode="aspectFill"/>
              <view class="online-dot" wx:if="{{item.isOnline}}"></view>
              <view class="mute-icon" wx:if="{{item.isMuted}}">ğŸ”‡</view>
            </view>
            
            <view class="chat-info">
              <view class="chat-header">
                <text class="name">{{item.name}}</text>
                <text class="time">{{item.time}}</text>
              </view>
              
              <view class="chat-footer">
                <!-- ç›¸å…³å•†å“æ ‡è¯† -->
                <view class="item-tag" wx:if="{{item.relatedItem}}">
                  <text>ğŸ·ï¸ {{item.relatedItem.title}}</text>
                </view>
                
                <text class="last-message" wx:else>{{item.lastMessage}}</text>
                
                <view class="message-status">
                  <view class="unread" wx:if="{{item.unreadCount > 0}}">
                    {{item.unreadCount > 99 ? '99+' : item.unreadCount}}
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{chatList.length === 0 && !refreshing}}">
        <view class="empty-icon">ğŸ’¬</view>
        <text class="empty-title">æš‚æ— èŠå¤©è®°å½•</text>
        <text class="empty-subtitle">å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªå¯¹è¯å§</text>
        <view class="start-chat-btn" bindtap="startNewChat">
          <text>å¼€å§‹èŠå¤©</text>
        </view>
      </view>

      <!-- æœç´¢æ— ç»“æœ -->
      <view class="no-results" wx:if="{{searchText && chatList.length === 0}}">
        <view class="no-results-icon">ğŸ”</view>
        <text class="no-results-title">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³èŠå¤©</text>
        <text class="no-results-subtitle">è¯•è¯•å…¶ä»–å…³é”®è¯</text>
      </view>
    </scroll-view>
  </view>
</view>